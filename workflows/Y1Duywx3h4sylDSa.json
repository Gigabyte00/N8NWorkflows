{
  "active": false,
  "connections": {
    "üìß Email or Chat?": {
      "main": [
        [
          {
            "node": "üìß Request Approval (Email)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üìù Format Chat Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chat Message Received": {
      "main": [
        [
          {
            "node": "AI Information Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üè¢ Check ERP System": {
      "main": [
        [
          {
            "node": "ü§ñ Generate Customer Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Information Extractor": {
      "main": [
        [
          {
            "node": "üìä Historical Support Cases",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìÑ Extract PDF Content": {
      "main": [
        [
          {
            "node": "üè¢ Check ERP System",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìã Aggregate Support Data": {
      "main": [
        [
          {
            "node": "üìö Download Product Manual",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìß Support Email Received": {
      "main": [
        [
          {
            "node": "AI Information Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìö Download Product Manual": {
      "main": [
        [
          {
            "node": "üìÑ Extract PDF Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìä Historical Support Cases": {
      "main": [
        [
          {
            "node": "üìã Aggregate Support Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìß Request Approval (Email)": {
      "main": [
        [
          {
            "node": "üì§ Send Response to Customer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ü§ñ OpenAI Model (Extractor)": {
      "ai_languageModel": [
        [
          {
            "node": "AI Information Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ü§ñ OpenAI Model (Generator)": {
      "ai_languageModel": [
        [
          {
            "node": "ü§ñ Generate Customer Response",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ü§ñ Generate Customer Response": {
      "main": [
        [
          {
            "node": "üìß Email or Chat?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-07-19T01:22:26.715Z",
  "id": "Y1Duywx3h4sylDSa",
  "isArchived": false,
  "meta": {
    "templateId": "5152"
  },
  "name": "Automate Customer Support with Gmail, Google Sheets, ERP Data & GPT-4o AI",
  "nodes": [
    {
      "parameters": {
        "content": "# üåê AI Customer Support Assistant - Cloud Version\n\n## What this workflow does:\nThis AI-powered customer support automation processes incoming support requests via email or chat, analyzes them using AI, retrieves relevant context, and generates draft responses for support agents.\n\n## Key Features:\n‚úÖ **Multi-channel Input**: Email & chat triggers\n‚úÖ **AI-powered Analysis**: Extracts sentiment, urgency, and key information\n‚úÖ **Context Integration**: Combines product manuals, ERP data, and support history\n‚úÖ **Draft Response Generation**: Creates professional responses in German\n‚úÖ **Human-in-the-loop**: Approval workflow before sending to customers\n\n## Demo Instructions:\n1. Use the Chat interface to test with sample customer queries\n2. Or send test emails to trigger the email workflow\n3. Watch how AI analyzes and generates contextual responses\n\n**üåê This is the CLOUD version using OpenAI and Google services**",
        "height": 760,
        "width": 450
      },
      "id": "b617607e-61ae-4107-a72e-2a23b5a57c75",
      "name": "üìã Workflow Overview",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        368,
        240
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## üìß Email Trigger\n\n**Purpose**: Monitors Gmail for incoming customer support requests\n\n**How it works**:\n‚Ä¢ Polls Gmail every minute for new emails\n‚Ä¢ Filters can be configured for specific labels/criteria\n‚Ä¢ Extracts email content, sender info, and metadata\n\n**Demo tip**: Send a test email to see this in action!",
        "height": 320,
        "width": 280,
        "color": 2
      },
      "id": "918dd7a6-1c69-43ed-872d-052ebf20a396",
      "name": "üìß Email Input",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        880,
        544
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "filters": {}
      },
      "id": "cd753c63-7f5f-4e44-901a-d23eca0cb8e9",
      "name": "üìß Support Email Received",
      "type": "n8n-nodes-base.gmailTrigger",
      "position": [
        992,
        912
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "content": "## üí¨ Chat Trigger\n\n**Purpose**: Provides a real-time chat interface for testing\n\n**How it works**:\n‚Ä¢ Creates a webhook URL for chat interactions\n‚Ä¢ Ideal for demos and testing scenarios\n‚Ä¢ Processes messages instantly\n\n**Demo tip**: Perfect for live demonstrations!",
        "height": 320,
        "width": 280,
        "color": 2
      },
      "id": "175a7569-f8d5-49b6-95ca-a83026b2aea4",
      "name": "üí¨ Chat Input",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        848,
        1408
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## üß† AI Information Extractor\n\n**Purpose**: Analyzes customer messages with AI to extract structured data\n\n**Extracts**:\n‚Ä¢ Category (technical, billing, sales, etc.)\n‚Ä¢ Urgency level (low, medium, high, critical)\n‚Ä¢ Customer sentiment\n‚Ä¢ Keywords for context search\n‚Ä¢ Product identifiers\n‚Ä¢ Required action type\n\n**AI Model**: OpenAI GPT-4o-mini",
        "height": 380,
        "width": 300,
        "color": 3
      },
      "id": "f9f43182-9113-4ba0-b2a9-b82f3f9b5d46",
      "name": "üß† AI Analysis",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1312,
        544
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "id": "99ce470b-9c71-4303-a515-d197bfbf2d78",
      "name": "ü§ñ OpenAI Model (Extractor)",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        1328,
        1232
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "content": "## üìä Historical Support Data\n\n**Purpose**: Retrieves previous support cases for context\n\n**Data Source**: Google Sheets with historical customer interactions\n\n**Contains**:\n‚Ä¢ Previous questions & answers\n‚Ä¢ Common issues & solutions\n‚Ä¢ Response templates\n‚Ä¢ Product-specific guidance\n\n**Why important**: Ensures consistent, high-quality responses",
        "height": 380,
        "width": 300,
        "color": 4
      },
      "id": "e55da351-bb97-49a8-bbe7-f9f5814f7874",
      "name": "üìä Context Data",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1920,
        544
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4/edit?usp=drivesdk",
          "cachedResultName": "Zeiss Primotech Demo customer requests"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": 1526853854,
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4/edit#gid=1526853854",
          "cachedResultName": "zeiss_primotech_support"
        },
        "options": {}
      },
      "id": "aaf740e0-d78b-41d3-ba92-811c32b06f76",
      "name": "üìä Historical Support Cases",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1920,
        1024
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "16e63750-b911-458d-b18d-7ced534dbc44",
      "name": "üìã Aggregate Support Data",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        2112,
        1024
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## üìö Product Knowledge Base\n\n**Purpose**: Accesses comprehensive product documentation\n\n**Data Source**: Google Drive (Primotech Manual PDF)\n\n**Contains**:\n‚Ä¢ Technical specifications\n‚Ä¢ Operating instructions\n‚Ä¢ Troubleshooting guides\n‚Ä¢ Safety information\n\n**Processing**: PDF text extraction for AI analysis\n\n**Cloud advantage**: Always up-to-date documentation",
        "height": 440,
        "width": 300,
        "color": 4
      },
      "id": "00c1c023-982b-49f7-a422-f02a3aa1c2a7",
      "name": "üìö Knowledge Base",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1536,
        1232
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "mode": "list",
          "value": "1_MKUQLEw2RS8k-QgAP5rtw-tD49A82lG",
          "cachedResultUrl": "https://drive.google.com/file/d/1_MKUQLEw2RS8k-QgAP5rtw-tD49A82lG/view?usp=drivesdk",
          "cachedResultName": "Primotech_Manual.pdf"
        },
        "options": {}
      },
      "id": "d4689f32-4c6c-4fab-94ef-4631b7b07632",
      "name": "üìö Download Product Manual",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1920,
        1392
      ],
      "typeVersion": 3
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "id": "c291af40-8db0-4050-ad29-17774465cdb0",
      "name": "üìÑ Extract PDF Content",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        2112,
        1392
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## üè¢ ERP System Integration\n\n**Purpose**: Retrieves customer & inventory data\n\n**Data Source**: Mock ERP API (demo purposes)\n\n**Provides**:\n‚Ä¢ Customer account information\n‚Ä¢ Order history\n‚Ä¢ Product availability\n‚Ä¢ Spare part pricing\n\n**Note**: In production, this would connect to your real ERP system\n\n**Cloud benefit**: Real-time data access",
        "height": 360,
        "width": 440,
        "color": 5
      },
      "id": "e9a2cbd2-07eb-41a3-9333-2a3d4b936fe2",
      "name": "üè¢ ERP Integration",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1872,
        1952
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "url": "https://run.mocky.io/v3/d8892875-55d6-449d-bab3-3cb7a7b419c0",
        "options": {}
      },
      "id": "861dd2a5-b3ad-463c-aa19-f79c7b51c424",
      "name": "üè¢ Check ERP System",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1936,
        1744
      ],
      "typeVersion": 3
    },
    {
      "parameters": {
        "content": "## ü§ñ Response Generation\n\n**Purpose**: Creates professional customer responses using AI\n\n**AI Model**: OpenAI GPT-4o-mini\n\n**Input Context**:\n‚Ä¢ Customer's original message\n‚Ä¢ Extracted information (sentiment, urgency, etc.)\n‚Ä¢ Product manual content\n‚Ä¢ Historical support cases\n‚Ä¢ ERP data (pricing, availability)\n\n**Output**: Professional German response following company standards",
        "height": 400,
        "width": 320,
        "color": 3
      },
      "id": "578d7499-4c72-4181-b1c8-89b05d3bdae0",
      "name": "ü§ñ AI Response Generation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2368,
        1264
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=This GPT acts as an expert customer support agent designed to draft thoughtful, accurate responses to customer queries. It takes in customer questions and leverages internal product documentation and a history of previously answered queries to prewrite complete and contextually appropriate replies. The GPT uses the full content of \n\n1. the uploaded Primotech Instruction Manual (in German): \n\n2. a CSV dataset of historical customer questions: {{ $('üìã Aggregate Support Data').item.json.data.toJsonString() }}\n\n3. Customer's original query: {{ \n$('Chat Message Received').isExecuted && $('Chat Message Received').last().json.chatInput;\n$('üìß Support Email Received') && $('üìß Support Email Received').item.json.snippet \n$('When clicking ‚ÄòExecute workflow‚Äô').isExecuted && $('When clicking ‚ÄòExecute workflow‚Äô').item.json.snippet\n}} \n\nand answers related to ZEISS Primotech microscopes. These sources provide comprehensive technical, usage, troubleshooting, and product-specific guidance.\n\nThe assistant aims to reduce agent workload by anticipating common follow-up questions, referencing appropriate product knowledge, and maintaining a polite, clear, and supportive tone. It is optimized for high response accuracy, minimal ambiguity, and internal efficiency.\n\nThe assistant never performs web searches. When the available context is insufficient to fully answer a query, it does not generate a customer email. Instead, it presents a warning for the human agent and offers any possibly relevant internal context that may assist in formulating a manual response.\n\nIt avoids answering questions that cannot be supported by available documentation and flags those for manual review. When generating responses, it uses complete, customer-facing sentences, structured for easy review and editing by human support agents, and may include links or references when based on internal content. Clarification is only requested when strictly necessary. If required data is missing, the assistant highlights placeholders for agent completion.\n\nAll responses that are complete must follow this structure:\n- Use a proper salutation starting with 'Sehr geehrter Herr' or 'Sehr geehrte Frau' followed by the customer's last name, if available. If no name is provided, use 'Sehr geehrte/r Kunde/in,'.\n- Begin with 'herzlichen Dank f√ºr Ihre Nachricht.'\n- Then insert the drafted response body.\n- If the request involves a spare part, the assistant uses the following API response and includes the relevant spare part name and price from the returned JSON: {{ $json.inventory.toJsonString() }}\n- Close with: 'Bei weiteren Fragen stehen wir Ihnen gerne zur Verf√ºgung, gerne k√∂nnen sie auch unsere (HILFE Seite)[http://www.zeiss.de] besuchen.' and 'Ich w√ºnsche Ihnen einen sch√∂nen Tag!'\n\nThe assistant uses professional and accessible language, aligned with the tone expected in technical product support, and maintains a helpful and competent demeanor throughout."
      },
      "id": "9858ac0e-2f3a-4476-a892-25c51b6dd654",
      "name": "ü§ñ Generate Customer Response",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        2336,
        1744
      ],
      "typeVersion": 1.6,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "id": "263a08b7-c29a-4556-af0d-2a42c7981f0f",
      "name": "ü§ñ OpenAI Model (Generator)",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        2352,
        1920
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "content": "## üë• Human-in-the-Loop Approval\n\n**Purpose**: Ensures quality control before sending responses\n\n**Process**:\n1. AI-generated response is sent to support agent\n2. Agent reviews and can approve/reject/modify\n3. Only approved responses are sent to customers\n\n**Benefits**:\n‚Ä¢ Quality assurance\n‚Ä¢ Learning from modifications\n‚Ä¢ Regulatory compliance\n\n**Note**: Critical for maintaining customer trust",
        "height": 460,
        "width": 320,
        "color": 6
      },
      "id": "769b302a-63b2-4801-9b0c-bb25d1f3e432",
      "name": "üë• Quality Control",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2800,
        1152
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "2473fa5c-8b22-479c-95e7-583d4adb934f",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $('üìß Support Email Received').isExecuted }}",
              "rightValue": "true"
            }
          ]
        },
        "options": {}
      },
      "id": "33aa86d8-f613-4d9b-921c-781c796b23d1",
      "name": "üìß Email or Chat?",
      "type": "n8n-nodes-base.if",
      "position": [
        2656,
        1744
      ],
      "typeVersion": 2.2,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "dummy@mail.com",
        "subject": "Customer Support Response - Approval Required",
        "message": "=A customer support response has been generated and requires your approval:\n\n**Customer Query**: \n{{ \n$('Chat Message Received').isExecuted ?? $('Chat Message Received').last().json.chatInput\n$('üìß Support Email Received').isExecuted ?? $('üìß Support Email Received').item.json.snippet \n$('When clicking ‚ÄòExecute workflow‚Äô').isExecuted ?? $('When clicking ‚ÄòExecute workflow‚Äô').item.json.snippet\n}}\n\n**Generated Response**:\n{{ $json.text }}\n\nPlease review and approve/reject this response.",
        "approvalOptions": {
          "values": {
            "approvalType": "double"
          }
        },
        "options": {}
      },
      "id": "8eee920b-1a44-4a8a-8db9-6ca32d9d0083",
      "name": "üìß Request Approval (Email)",
      "type": "n8n-nodes-base.gmail",
      "position": [
        2832,
        1648
      ],
      "webhookId": "7e79cf64-9f20-4968-9bca-3f4dca48ec4c",
      "typeVersion": 2.1
    },
    {
      "parameters": {
        "sendTo": "={{ $('üìß Support Email Received').item.json.From }}",
        "subject": "Re: Your Support Request",
        "message": "={{ $('ü§ñ Generate Customer Response').item.json.text }}",
        "options": {}
      },
      "id": "eee108b0-2d0d-4140-b298-ac0a6bb4422e",
      "name": "üì§ Send Response to Customer",
      "type": "n8n-nodes-base.gmail",
      "position": [
        3056,
        1648
      ],
      "webhookId": "c994c7a5-5edb-4167-81dd-22e33625450a",
      "typeVersion": 2.1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "409c228d-783f-4e7f-aa47-f0271d8409f8",
              "name": "text",
              "type": "string",
              "value": "={{ $json.text }}"
            }
          ]
        },
        "options": {}
      },
      "id": "b6bb5258-6b1b-48b1-994b-9dbed3062559",
      "name": "üìù Format Chat Response",
      "type": "n8n-nodes-base.set",
      "position": [
        2832,
        1840
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "3815458b-3b11-472f-9718-f9fd523b3325",
      "name": "Chat Message Received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        992,
        1264
      ],
      "webhookId": "3ec1feb8-fc70-4e24-9370-debc47defe81",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "text": "={{ $json.chatInput ? $json.chatInput : $json.snippet }}",
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"category\", \"urgency\", \"sentiment\", \"keywords\", \"productIdentifiers\", \"customerInfo\", \"requiredAction\"],\n  \"properties\": {\n    \"category\": {\n      \"type\": \"string\",\n      \"enum\": [\"technical\", \"billing\", \"sales\", \"returns\", \"general\"],\n      \"description\": \"The primary category of the customer request\"\n    },\n    \"urgency\": {\n      \"type\": \"string\",\n      \"enum\": [\"low\", \"medium\", \"high\", \"critical\"],\n      \"description\": \"How time-sensitive the request is\"\n    },\n    \"sentiment\": {\n      \"type\": \"string\",\n      \"enum\": [\"positive\", \"neutral\", \"negative\", \"very_negative\"],\n      \"description\": \"The emotional tone of the customer's message\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      },\n      \"description\": \"Key terms extracted from the request for searching knowledge base and ERP\"\n    },\n    \"productIdentifiers\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"type\": \"string\",\n            \"enum\": [\"model\", \"serial\", \"part\"]\n          },\n          \"value\": {\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"description\": \"Any product numbers, models, or parts mentioned in the request\"\n    },\n    \"customerInfo\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"firstName\": {\n          \"type\": \"string\"\n        },\n        \"lastName\": {\n          \"type\": \"string\"\n        },\n        \"customerId\": {\n          \"type\": \"string\",\n          \"description\": \"CRM Customer Id\"\n        },\n        \"mentionsCompetitor\": {\n          \"type\": \"boolean\",\n          \"description\": \"Customer references a competitor product or service\"\n        }\n      }\n    },\n    \"requiredAction\": {\n      \"type\": \"string\",\n      \"enum\": [\"information\", \"replacement\", \"refund\", \"repair\", \"callback\", \"escalation\"],\n      \"description\": \"The primary action needed to resolve the customer's request\"\n    }\n  }}",
        "options": {}
      },
      "id": "9f6013c5-f25f-4134-b9b3-9eed10e10db8",
      "name": "AI Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "position": [
        1312,
        1024
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## How to run a demo\n- add google / openai credentials\n- change email of approver to something you can access",
        "height": 200,
        "width": 440,
        "color": 7
      },
      "id": "7fc3e443-9653-4706-a612-413fb6df1e23",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        368,
        1040
      ],
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-07-19T01:22:26.715Z",
  "versionId": "9bf6451f-4644-49c9-8e27-2de9e17827d8"
}